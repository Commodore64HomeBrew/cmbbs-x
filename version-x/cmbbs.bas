!--------------------------------------------------
!- September-28-17 7:38:48 PM
!- Import of : 
!- c:\users\kevin\homebrew\cmbbs-x\cmbbs.prg
!- Commodore 64
!--------------------------------------------------
10 CLR
11 DW$="cd///"
15 POKE53280,0:POKE53281,0:SYS53186:GOTO130
20 CLOSE15:OPEN15,A2,15:RETURN
25 CLOSE2:CLOSE8:CLOSE15:RETURN
30 GOTO495
35 GOTO515
40 GOTO2380
45 PRINT#8,ZA$","ZC$","ZG","ZH","ZW$","ZX$","ZY$","ZZ$","ZD","W1%","W2%","W3%
55 RETURN
65 SYS52962:I=1:FORI=1TO3800:NEXT:RETURN
70 A=VAL(TI$)
75 IFA>TL-200ANDA<TLANDSL<8THENO$="{reverse on}{red}Time is nearly up!":GOSUB30
80 IFA>TLANDSL<8THENO$="{reverse on}{red}Your time is up!":GOSUB30:GOSUB3510:GOSUB1915:CLR:GOTO15
85 RETURN
90 GOSUB25:OPEN15,DB,15,DX$:OPEN8,DB,2,"0:userlog":RETURN
95 I$=LEFT$(I$,1):RETURN
100 I$=LEFT$(I$,3):RETURN
105 O$="{red}{reverse on}Sorry Charlie...":GOSUB30:RETURN
110 A=W5%*PEEK(844)+W4%-W6%:RETURN
115 I$=LEFT$(I$,2):RETURN
120 GOSUB65:PRINT#5,"{ct a*3}";:GOSUB65:RETURN
125 POKE667,PEEK(668):RETURN
130 CLOSE5:OPEN5,2,0,CHR$(6)+CHR$(0):POKE56579,0:B=223
135 GOSUB65:PRINT#5,"atm0v1s7=40q1e0s2=1s0=1":GOSUB65
145 POKE828,2:POKE840,0:POKE683,0:POKE54276,32:GOTO4280
150 RB$=CHR$(8):LF=1:IFMQTHENRB$=CHR$(20):LF=0
155 RETURN
160 OPEN8,DA,2,"0:callers,a":RETURN
165 SYS53186:A$=MID$(STR$(SL),2)+" "+NA$+" ["+MID$(STR$(UN),2)+"]"+CHR$(13)
170 SYS52565:SYS53160:RETURN
175 GOSUB465:POKE849,0:POKE52704,45:SYS53076:RETURN
180 IFPEEK(834)=1THENCLOSE8:GOSUB6000:GOSUB160
190 RETURN
195 IFA2<8ORA2>11THENAB=1:RETURN
200 GOSUB20:CLOSE15:IF(ST)THENAB=1
205 RETURN
210 PRINT#8:I=1:FORI=1TOLS%:PRINT#8,AR$(I);:NEXT:CLOSE8:GOSUB1455:RETURN
215 CLOSE15:OPEN15,PEEK(2),15,DW$:CLOSE15:OPEN8,PEEK(2),2,"0:stats,s,r":RETURN
230 O$="{red}{reverse on}Invalid ID#{reverse off}":GOSUB30:RETURN
235 R$="{blue}Selection=:>":GOSUB40:RETURN
240 O$="{cyan}{reverse on}All new messages!{reverse off}":GOSUB30:RETURN
245 O$="{red}{reverse on}No new messages.{reverse off}":GOSUB30:RETURN
250 R$="Device Number=:>":GOSUB40:GOSUB115:RETURN
252 R$="Device Cmd=:>":GOSUB40:GOSUB115:RETURN
255 O$="{clear}{reverse on}{cyan}=:> "+NA$:GOSUB30:IFGUTHENFT$="menu-guest":GOTO275
260 IFSL<2THENFT$="menu-new"
265 IFSL>1ANDSL<PEEK(837)THENFT$="menu-validated"
270 IFSL>=PEEK(837)THENFT$="menu-expert"
271 IFSL=10THENFT$="menu-sysop"
275 GOSUB25:GOSUB6000:DE=DA:GOSUB1460
280 XZ=0
285 QA=0:U9=0:LS%=0:CD=0:NZ=0:FM=0:LW=0
290 IFXZ>2THENSYS52673:GOSUB3570:GOSUB590:CLR:GOTO15
295 GOSUB35:GOSUB70:GOSUB520:O$="{light blue}"+SU$(VI):GOSUB30
300 O$="{gray}{reverse on}"+OA$+"{reverse off}{purple} sez..{white} "+OL$:GOSUB30
305 R$="{cyan}{reverse on}["+LEFT$(MID$(TI$,3),2)+"]{reverse off} {reverse on}["+TM$+"]{reverse off} {reverse on}[2400]{reverse off}"
310 R$=R$+"{blue} [?]=:>":GOSUB40:O$="{ct n}":GOSUB30:GOSUB100:GOSUB5095
315 IFI$="dow"THENK1=0:GOSUB3185:GOTO280
320 IFI$="dir"ORI$="$"THENGOSUB2920:GOTO280
330 IFI$="upl"THENGOSUB3275:GOTO280
335 IFI$="cha"ANDSL>=PEEK(837)THENGOSUB5835:GOTO280
340 IFI$="bad"ANDSL>=10GOTO3945
345 IFI$="cmd"THENO$="{reverse off}{red}Nice Try!!":GOSUB30:GOSUB35:XZ=4:GOTO290
350 GOSUB115:IF(VAL(I$)>0ORLEFT$(I$,1)="0")ANDSL>0THENGOSUB1855:GOTO280
355 GOSUB95:IFI$="?"ORI$=G$GOTO255
360 IFI$="c"THENGOSUB2755:GOTO285
365 IFI$="r"THENXX=1:MS=0:GOSUB850:GOTO280
370 IFI$="n"THENGOSUB4525:GOTO280
375 IFI$="*"THENFT$="graphic":GOTO275
380 IFI$="@"THENGOSUB1760:GOTO280
385 IFI$="w"THENFT$="list":GOTO275
390 IFI$="#"THENGOSUB1835:GOTO280
395 IFI$="s"THENGOSUB745:GOTO280
396 IFI$="%"ANDSL>=1THENGOSUB461:GOTO280
400 IFI$="p"THENGOSUB980:GOTO280
405 IFI$="!"THENGOSUB550:GOTO280
410 IFI$="b"THENMQ=1-MQ:GOSUB150:GOTO280
415 IFI$="a"ANDAK<>1ANDPEEK(841)<>0GOTO2110
420 IFI$="i"THENFT$="info":GOTO275
425 IFI$="h"THENFT$="help":GOTO275
430 IFI$="o"ANDGU=1THENFT$="guest welcome":GOTO275
435 IFI$="o"THENFT$="welcome":GOTO275
440 IFI$="f"THENGOSUB1070:GOTO280
445 IFI$="g"GOTO480
450 IFI$="l"THENGOSUB2830:GOTO280
455 IFI$="m"THENGOSUB1505:GOTO280
460 GOSUB35:XZ=XZ+1:GOTO285
461 O$="What ya got to say for yourself":GOSUB30
462 R$="=>":GOSUB40:GOSUB610:IFI$=""THENRETURN
463 OL$=I$:OA$=NA$:RETURN
465 SYS51339:IFPEEK(251)=0THENRETURN
470 IFCD=2THENAB=1
475 RETURN
480 R$="{cyan}Confirm logoff{reverse on}[Y]{reverse off}=:>":RP=1:GOSUB40:GOSUB5095
485 IFI$="y"THENGOSUB3510:GOSUB1915:GOSUB120:CLR:GOTO15
490 GOTO280
495 IFO$=""THENRETURN
500 POKE251,LEN(O$):O$=O$+"":SYS52540:O$=""
505 POKE680,CD:POKE848,MQ:SYS927:AB=PEEK(251):IFLFTHENPRINT#5,"{ct j}";:GOSUB465
510 RETURN
515 PRINT:IFPEEK(840)<>1THENPRINT#5:IFLFTHENPRINT#5,"{ct j}";:RETURN
520 TM$="":H=PEEK(56331):H1=(HAND16)/16:H2=HAND15:M=PEEK(56330)
525 M1=(MAND240)/16:M2=MAND15:T=PEEK(56328)AND15:TM$=MID$(STR$(H1),2)
530 IFTM$="0"THENTM$=""
535 TM$=TM$+MID$(STR$(H2),2)+":"+MID$(STR$(M1),2)+MID$(STR$(M2),2)
540 IF(HAND128)/128=1THENTM$=TM$+" pm":RETURN
545 TM$=TM$+" am":RETURN
550 IFSL<1ORKL=1THENRETURN
555 GOSUB35:GOSUB90:R=UN+1:GOSUB5455:O$="Password is:"+ZC$:GOSUB30
560 R$="New password=:>":GOSUB40:GOSUB610:ZC$=I$
565 IFI$=G$THENGOSUB25:RETURN
570 IFLEN(I$)>9THENO$="{reverse on}Too long!":GOSUB30:GOTO560
575 O$="New password:"+ZC$:GOSUB30:R$="Correct [Y/N]=>"
580 GOSUB40:GOSUB95:GOSUB5095:IFI$<>"y"GOTO560
585 PA$=ZC$:GOSUB4260:GOSUB45:GOSUB25:KL=1:RETURN
590 I=0:FORI=0TONS:IFRQ(I)>RW(I)THENGOSUB600
595 NEXT:RETURN
600 Z=RW(I)+1:FORZ=RW(I)+1TORQ(I):A$="."+STR$(I):IFI=0THENA$=""
605 CLOSE15:OPEN15,DA,15,"s0:"+MID$(STR$(Z),2)+A$:NEXT:CLOSE15:RETURN
610 SC$="":Z=1:FORZ=1TOLEN(I$):A$=MID$(I$,Z,1)
615 IFA$=","ORA$=":"ORA$=";"THENA$="-"
620 SC$=SC$+A$:NEXT:I$=SC$:RETURN
645 A=PEEK(834):IFA=2THENRETURN
655 GOSUB25:OPEN15,DA,15,DW$:GOSUB160:GOSUB4270
660 IFEN>20THENCLOSE8:OPEN8,DA,2,"0:callers,s,w"
665 NN$="":IFNWTHENNN$="-NEW USER"
670 PRINT#8,STR$(CL);:PRINT#8," ";:PRINT#8,U$;:PRINT#8," ";:PRINT#8,NA$;:PRINT#8," ";
675 PRINT#8,LT$;:PRINT#8," ":CLOSE8:RETURN
680 GOSUB25:GOSUB6000:OPEN8,DA,2,"0:callers":O$="{clear}Last callers:"
681 GOSUB30
685 GOSUB1480:GOSUB25:R$="{down}Delete file[y/n]":RP=1:GOSUB40:GOSUB35
690 IFI$<>"y"ANDI$<>"Y"THENRETURN
695 OPEN15,DA,15,"s0:callers":GOSUB25:OPEN8,DA,2,"0:callers,s,w"
700 GOSUB25:RETURN
705 IFMS<1THENRETURN
710 IFMS>NMTHENO$="{yellow}{reverse on}End of msgs":GOSUB30:AA=1:FU=1:RETURN
715 GOSUB35:O$="{ct n}{reverse on}["+MID$(STR$(MS),2)+"]":IFU9=0ANDU8=0THENO$="{clear}{down}"+O$
720 GOSUB30:GOSUB35:MS=INT(MS):CLOSE8:LR=MS:ZM=DE:DE=ZO(VI)
725 FT$=MID$(STR$(MS),2)+SU$:CLOSE8:GOSUB5800
726 OPEN8,DE,2,"0:"+FT$:AG=0:AB=0:INPUT#8,A$
730 INPUT#8,MT$:INPUT#8,B$:FU=VAL(B$):O$=MT$:GOSUB30:O$=B$:GOSUB30:A$=""
735 GOSUB1480:DE=ZM:IFABTHENU9=0
740 RETURN
745 IFSL<0THENRETURN
750 O$=" Scan "+SU$(VI):GOSUB30:GOSUB35:O$=STR$(NM)+" messages"
755 GOSUB30:IFNM<1THENO$="{red}{reverse on}No msg's to scan":GOSUB30:RETURN
760 R$="{blue}Start scan at # =:>":GOSUB40:GOSUB100:XX=INT(VAL(I$))
765 IFXX=0THENRETURN
770 IFNM<1THENO$="{red}{reverse on}No msg's to scan":GOSUB30:RETURN
775 IFXX>NMORXX<0THENO$="{red}{reverse on}No such msg":GOSUB30:RETURN
780 IFXX>=NMTHENXX=NM
785 X=NM-XX:IFX>5THENX=5
790 GOSUB35:O$="{light blue}Scanning:":GOSUB30:GOSUB35:CLOSE8:GOSUB5800:I=XX:FORI=XXTOXX+X
795 OPEN8,ZO(VI),2,"0:"+MID$(STR$(I),2)+SU$
796 INPUT#8,A$:INPUT#8,MT$:INPUT#8,X$:INPUT#8,B$
800 INPUT#8,Y$:O$="{cyan}{reverse on}"+MID$(STR$(I),2)+"{reverse off}{green} "+MT$:GOSUB30:IFABGOTO815
805 O$="{blue}{space*4}"+Y$+" "+X$:GOSUB30:GOSUB35:IFABGOTO815
810 GOSUB25:NEXT
815 GOSUB25:IFU9=1ANDAB<>1ANDAA<>1GOTO880
820 IFAAGOTO860
825 GOSUB35
830 O$="{cyan}{reverse on}[c]{reverse off}{blue}ontinue scan{space*3}{cyan}{reverse on}[a]{reverse off}{blue}bort{space*3}{cyan}{reverse on}[r]{reverse off}{blue}e-read"
835 GOSUB30:O$="{cyan}{reverse on}[s]{reverse off}{blue}croll msgs{space*5}{cyan}{reverse on}[p]{reverse off}{blue}ost msg":GOSUB30
840 O$="{cyan}{reverse on}[*]{reverse off}{blue}reply{space*10}{cyan}{reverse on}[m]{reverse off}{blue}ail to{sh space}user#"+STR$(FU)
845 GOSUB30
850 O$="{cyan}Separate msgs with[:]":GOSUB30
855 PRINT"{purple}<K>ill <CTRL P>rint{yellow}"
860 IFAATHENAA=0:MS=0:U9=0:CLOSE8:FU=1:RETURN
865 GOSUB70:GOSUB35:U8=0
870 R$="{white}{reverse on}[?]{reverse off}{blue} msg # to read [last="+MID$(STR$(MS),2)+"]=:>"
875 GOSUB40:GOSUB35
880 O$="{ct n}":GOSUB30:GOSUB35:GOSUB5095:A$=LEFT$(I$,1)
885 IFA$="k"ANDSL>9THENGOSUB1035:GOTO860
890 IFA$="a"THENGOSUB25:MS=0:U9=0:FU=0:RETURN
895 IFA$="m"ANDSL>1THENGOSUB1620:GOTO860
900 IFA$="r"THENGOSUB705:GOTO815
905 IFA$="*"THENLI$="Reply-"+MT$:GOSUB980:LI$="":GOTO860
910 IFA$="s"THENU9=1:UB=1
915 IFU9=1ANDAB<>1ANDAA<>1THENMS=MS+1:GOSUB705:GOTO815
920 IFA$=G$THENMS=MS+1:GOSUB705:GOTO860
925 IFA$="p"THENGOSUB980:GOTO815
930 IFA$="?"GOTO815
935 IFVAL(LEFT$(I$,3))<1GOTO960
940 IFA$="c"ANDNM>1GOTO960
945 MS=INT(VAL(LEFT$(I$,3))):GOSUB705:IFABGOTO860
950 AB=0:GOSUB5610:U8=1:IFABGOTO860
955 GOTO945
960 IFA$<>"c"GOTO865
965 IFNM<1THENO$="{red}{reverse on}No msgs":GOSUB30:GOTO865
970 XX=XX+X+1:MS=XX-1:IFXX>NMTHENXX=1:MS=XX-1
975 GOTO780
980 IFNW=1ORSL<2THENGOSUB105:RETURN
985 O$="Posting on:"+SU$(VI):GOSUB30:GOSUB35:MK=0:AG=0:GOSUB1120
990 MK=0:IFAGTHENAG=0:RETURN
995 IFLS%<2THENO$="{reverse on}Nothing to save":GOSUB30:RETURN
1000 NM=NM+1:IFMKTHENNM=WW:RETURN
1005 O$="{yellow}{reverse on}Sending-":GOSUB30:GOSUB520:GOSUB25:GOSUB5800
1010 OPEN8,ZO(VI),2,"@0:"+MID$(STR$(NM),2)+SU$+",s,w":PRINT#8,CL-1:PRINT#8,MT$
1015 PRINT#8,MID$(STR$(UN),2)+" {reverse on}["+NA$+"]":PRINT#8,TM$:PRINT#8,DA$:PRINT#8,YL$
1020 IFLI$>""THENPRINT#8,LI$
1025 GOSUB210:W4%=W4%+1:R=UN+1:GOSUB90:GOSUB4260:GOSUB2045
1030 O$="{yellow}{reverse on}It's sent-":GOSUB30:RQ(VI)=NM:RW(VI)=MN:RETURN
1035 MK=MS:CLOSE8:IFMK<1ORMK>NMTHENRETURN
1040 PRINT"{yellow}{reverse on}Scratching"+STR$(MK):GOSUB5800:OPEN15,ZO(VI),15
1045 PRINT#15,"s0:"+MID$(STR$(MK),2)+SU$:D0=MK+1:AA$="":BB$="":CC$=""
1050 IFMK=NMGOTO1065
1055 I=D0:FORI=D0TONM:POKE1063,I+48
1060 PRINT#15,"r0:"+MID$(STR$(I-1),2)+SU$+"="+MID$(STR$(I),2)+SU$:NEXTI
1065 NM=NM-1:RQ(VI)=NM:RW(VI)=MN:GOSUB25:GOSUB1920:PRINT"done":RETURN
1070 IFPEEK(684)=1ANDGU=1THENGOSUB105:RETURN
1075 LI=0:O$="Feedback to "+VI$:GOSUB30
1080 IFPEEK(834)<>0THENFU=1:GOTO1630
1085 IFFD>3THENO$="{red}{reverse on}Too much feedback!":GOSUB30:RETURN
1120 IFJP>3ANDSL<10THENO$="{red}{reverse on}Msg. limit exceeded!":GOSUB30:AG=1:RETURN
1125 GOSUB35:R$="{orange}Subject=:>":GOSUB40:IFI$=G$THENAG=1:RETURN
1130 JP=JP+1:GOSUB610:MT$=SC$
1135 IFLEN(MT$)>35THENO$="{reverse on}{yellow}Too long":GOSUB30:GOTO1125
1140 GOSUB1455:D9=FRE(0)-1000:R$="":CD=1
1145 O$="{yellow}{clear}{space*10}{reverse on}{down}Message Maker":GOSUB30:LS%=1:GOSUB35
1150 AG=0:AL=0:AK=0:O$="{cyan}{reverse on}CTRL W{reverse off}{blue} Word wrap toggle":GOSUB30
1155 IFMQTHENO$="{cyan}{reverse on}CTRL L{reverse off}{blue} Lowercase graphics":GOSUB30
1160 IFSL>9THENO$="{cyan}{reverse on}CTRL O{reverse off}{blue}{purple} Load a file":GOSUB30
1165 O$="{cyan}{reverse on}CTRL Y{reverse off}{blue} Quicksave msg":GOSUB30
1170 O$="{cyan}{reverse on}CTRL Z{reverse off}{blue} Re-type previous line":GOSUB30
1175 IFMQTHENO$="{cyan}{reverse on}CTRL U{reverse off}{blue} Uppercase graphics":GOSUB30
1180 O$="{cyan}{reverse on}CTRL X{reverse off}{blue} or /EX on a blank line to end":GOSUB30
1190 O$="{reverse on}{blue}word wrap on":GOSUB30:GOSUB35:O$="{reverse on}begin{reverse off}{light gray}":GOSUB30
1195 GOSUB35:CD=0:FM=1
1200 NZ=1:QA=1:LW=1:GOSUB40:IFAK=1THENAK=0:GOTO1245
1205 IFQP%=1THENQP%=0:GOTO1330
1210 IFALTHENAL=0:D9=D9+LEN(AR$(LS%+1)):GOTO1200
1215 IFAK=2THENAK=0:QA=0:NZ=0:AG=0:RETURN
1220 AR$(LS%)=I$:D9=D9-LEN(I$)
1225 IFLS%>=100ORD9<250GOTO1245
1230 IFD9<400THENO$="{reverse on}very low on memory":GOSUB30
1235 LS%=LS%+1:IFLS%=95THENO$="{reverse on}5 lines left!":GOSUB30
1240 GOTO1200
1245 AR$(LS%)=I$:NZ=0:QA=0:LW=0:GOSUB35:O$="{cyan}{reverse on}end.":GOSUB30
1250 IFAR$(LS%)=""ORAR$(LS%)="{ct x}"THENLS%=LS%-1
1255 GOSUB35
1260 O$="{cyan}{reverse on}[s]{reverse off}{blue}ave {cyan}{reverse on}[e]{reverse off}{blue}dit {cyan}{reverse on}[r]{reverse off}{blue}ead {cyan}{reverse on}[a]{reverse off}{blue}bort"
1265 GOSUB30:LW=0:O$="{cyan}{reverse on}[c]{reverse off}{blue}ontinue":GOSUB30
1270 R$="cmd {reverse on}{cyan}[fre="+MID$(STR$(D9),2)+"]{reverse off}{blue}=:>":GOSUB40:O$="{ct n}"
1275 GOSUB30:GOSUB95:IFI$="a"THENO$="{red}{reverse on}Quit":GOSUB30:GOTO1305
1280 IFI$="r"ANDLS%>0GOTO1320
1285 IFI$="e"ANDLS%>0ANDLS%<101THENFM=0:GOSUB1370:GOTO1255
1290 IFI$="c"ANDLS%<95GOTO1225
1295 IFI$="s"THENAG=0:RETURN
1300 GOTO1255
1305 R$="{reverse on}are you sure?":GOSUB40:GOSUB5095:GOSUB95
1310 IFI$="y"THENAG=1:GOSUB1455:RETURN
1315 GOTO1255
1320 O$="{reverse on}"+STR$(LS%)+" {reverse off} lines in message.":GOSUB30:GOSUB35
1325 O$="[spacebar] to pause {reverse on}A{reverse off} to quit.":GOSUB30
1330 O$="continue typing after reading or CTRL X.":GOSUB30
1335 I=0:GOSUB35
1340 I=I+1:O$=AR$(I):GOSUB30:IFABGOTO1255
1345 IFI=LS%GOTO1360
1350 GOTO1340
1355 IFLS%<95ANDRIGHT$(AR$(LS%),1)<>G$THENI$=AR$(LS%):GOSUB2420:GOTO1220
1360 IFLS%<95GOTO1225
1365 GOTO1245
1370 J=1:O$="{clear}":GOSUB30:I1=1:FORI1=1TOLS%:J=J+1
1375 O$="{cyan}{reverse on}"+MID$(STR$(I1),2)+"{reverse off}":GOSUB30:O$=AR$(I1):GOSUB30:IFABTHENRETURN
1380 IFJ=9THENO$="{reverse on}press {reverse off}c{reverse on} to change a line other continues":GOSUB30
1385 IFJ=9THENQA=0:RP=1:GOSUB40:J=1:GOSUB5095:IFI$="c"THENGOSUB1405
1390 NEXT:O$="{reverse on}press {reverse off}c{reverse on} to change a line other ends.":GOSUB30
1395 QA=0:RP=1:GOSUB40:GOSUB5095:IFI$="c"THENGOSUB1405
1400 RETURN
1405 GOSUB35:O$="{reverse on}line # to change or RETURN quits":GOSUB30
1410 GOSUB40:IFI$=G$THENRETURN
1415 IFD9<250THENO$="{reverse on}{red}Not enough memory":GOSUB30:RETURN
1420 GOSUB100:A1=INT(VAL(I$)):IFA1<1ORA1>LS%GOTO1405
1425 O$=AR$(A1):GOSUB30
1430 O$="{purple}{reverse on}enter new text or {pound}d to delete line":GOSUB30:R$=""
1435 NZ=1:QA=1:GOSUB40:NZ=0
1440 IFI$=G$THENO$="{yellow}{reverse on}no change":GOSUB30:GOTO1405
1445 IFI$="{pound}d"+G$THENAR$(A1)="":O$="{reverse on}deleted":GOSUB30:GOTO1405
1450 D9=D9+LEN(AR$(A1)):AR$(A1)=I$:D9=D9-LEN(I$):GOTO1405
1455 I=1:FORI=1TO100:AR$(I)="":NEXT:FM=0:RETURN
1460 IFCD=0THENGOSUB35:O$="{cyan}{reverse on}[SPACEBAR]{reverse off} pauses{space*2}{reverse on}A{reverse off} aborts":GOSUB30:IFABTHENRETURN
1465 GOSUB35
1470 GOSUB25:OPEN15,DE,15:CLOSE15:IF(ST)THENRETURN
1475 OPEN8,DE,2,"0:"+FT$:AB=0:AG=0:O$="{cyan}":GOSUB30
1480 IFABORAGGOTO1500
1485 SYS52640:IF(ST)THENAG=1
1490 GOSUB505:IFBSTHENGOSUB5030
1495 GOTO1480
1500 GOSUB25:AG=0:GOSUB35:RETURN
1505 IFNW=1ORSL<2THENGOSUB105:RETURN
1510 O$="{yellow}{clear}{down}{space*3}{reverse on}Electronic Mail{space*3}":GOSUB30:GOSUB35
1515 O$="{cyan}{reverse on}[0]{reverse off}{blue} Mail to "+VI$:GOSUB30
1520 O$="{cyan}{reverse on}[1]{reverse off}{blue} Send mail by user number":GOSUB30
1525 O$="{cyan}{reverse on}[2]{reverse off}{blue} Scan userlog":GOSUB30
1530 O$="{cyan}{reverse on}[3]{reverse off}{blue} User Search System(USS)":GOSUB30:GOSUB35:GOSUB235
1535 GOSUB95:GOSUB35:IFI$="1"GOTO1610
1540 IFI$="2"THENGOSUB1680
1545 IFI$="3"THENGOSUB5135:KZ%=0
1550 IFI$="0"THENFU=1:GOTO1630
1555 RETURN
1560 QM=1:FORQM=1TOMW:FT$=STR$(UN)+"-"+MID$(STR$(QM),2)
1562 CLOSE8:GOSUB6010
1565 OPEN8,DC,2,"0:"+FT$:INPUT#8,AA$:INPUT#8,BB$:INPUT#8,CC$:GOSUB25:ZM=DC
1570 DE=DC:GOSUB1470:DE=ZM:GOSUB25
1575 O$="{cyan}{reverse on}[a]{reverse off}{blue}uto-reply{space*2}{cyan}{reverse on}[r]{reverse off}{blue}e-read{space*2}{cyan}{reverse on}[d]{reverse off}{blue}elete"
1580 GOSUB30:R$="{yellow}command=:>":GOSUB40:GOSUB95:GOSUB5095:O$="{ct n}":GOSUB30
1585 IFI$="r"GOTO1565
1590 IFI$="a"THENPB=1:I$=RIGHT$(CC$,3):GOSUB1615
1595 NEXT:ED=ED-MW:O$="{yellow}{reverse on}Trashing your old mail-":GOSUB30:GOSUB25
1600 GOSUB6010:OPEN15,DC,15:PRINT#15,"s0:"+STR$(UN)+"-*":GOSUB25:MW=0:QW=0:FU=UN
1605 GOSUB2105:GOSUB1920:RETURN
1610 R$="{blue}User#=:>":GOSUB40:IFI$=G$THENRETURN
1615 GOSUB100:FU=INT(VAL(I$))
1620 IFFU<1ORFU>NUTHENGOSUB230:RETURN
1625 IFED>=EM%THENO$="{red}{reverse on}Mail base full-try later!":GOSUB30:RETURN
1630 GOSUB2075:IFQW=-1THENO$="{red}{reverse on}User's mailbox full":GOSUB30:RETURN
1635 IFQW=-2THENRETURN
1640 GOSUB1120:IFAGTHENAG=0:RETURN
1645 O$="{yellow}{reverse on}Sending-":GOSUB30:ED=ED+1:GOSUB1920:QW=QW+1
1650 IFFU=1THENPOKE831,PEEK(831)+1
1655 IFQW<1THENQW=1
1658 GOSUB6010
1660 CLOSE8:OPEN8,DC,2,"@0:"+STR$(FU)+"-"+MID$(STR$(QW),2)+",s,w":GOSUB520
1665 PRINT#8,MT$:PRINT#8,"From: "+NA$:PRINT#8,"User# "+STR$(UN)
1670 PRINT#8,"Time: "+TM$:PRINT#8,"Date{sh space}"+DA$:PRINT#8," "+YL$:GOSUB210:GOSUB2105
1675 O$="{yellow}{reverse on}It's sent-":GOSUB30:RETURN
1680 O$="{clear}{yellow}Search users":GOSUB30
1685 O$="{green}There are"+STR$(NU)+" users":GOSUB30
1690 R$="{blue}Start search at user #=:>":GOSUB40:GOSUB100
1695 KK=INT(VAL(I$)):IFKK<1ORKK>NUORI$=G$THENRETURN
1700 GOSUB90:I=KK:FORI=KKTONU:R=I+1:GOSUB5455:GOSUB35
1705 O$="{green}User"+STR$(I)+": "+ZA$:GOSUB30:IFABTHENO$="":GOSUB25:RETURN
1710 O$="{light gray}-----------":GOSUB30:IFABGOTO1750
1715 O$="{cyan}# letters:"+STR$(ZH):GOSUB30:IFABGOTO1750
1720 O$="{blue}Computer : "+ZX$:GOSUB30:IFABGOTO1750
1725 O$="{yellow}Location : "+ZY$:GOSUB30:IFABGOTO1750
1730 O$="{brown}Last on{space*2}: "+ZW$:GOSUB30:IFABGOTO1750
1735 IFSL<9GOTO1750
1740 O$="{purple}Sec. lvl :"+STR$(ZG):GOSUB30
1745 O$="{purple}Post/U/D :"+STR$(W1%)+STR$(W2%)+STR$(W3%):GOSUB30
1750 IFABTHENI=NU
1755 NEXT:GOSUB25:RETURN
1760 IFGUTHENPRINT"{white}{space*6}No status until you apply!":RETURN
1765 O$="{clear}{space*5}{down}{reverse on}{white}Your user status{reverse off}":GOSUB30:GOSUB35:GOSUB35
1770 GOSUB90:R=UN+1:GOSUB5455:GOSUB25:O$="{orange}Name :"+ZA$:GOSUB30
1775 O$="{pink}Location :"+ZY$:GOSUB30:O$="{gray}Email:"+ZZ$:GOSUB30
1780 O$="{light green}Computer:"+ZX$:GOSUB30
1785 O$="{light blue}Number of users{space*2}"+STR$(NU):GOSUB30
1790 O$="{light gray}Your security is "+STR$(ZG):GOSUB30
1795 O$="{white}Messages posted{space*2}"+STR$(W1%):GOSUB30
1800 O$="{cyan}Uploads{space*10}"+STR$(W2%):GOSUB30
1805 O$="{green}Downloads{space*8}"+STR$(W3%):GOSUB30:IFSL>PEEK(681)GOTO1815
1810 IFPEEK(843)=1THENGOSUB110:O$="{blue}Credits remaining"+STR$(A):GOSUB30
1815 O$="{yellow}Elapsed time{space*6}"+LEFT$(MID$(TI$,3),2)+" min.":GOSUB30
1820 O$="{brown}Current board{space*5}"+SU$(VI):GOSUB30:ZZ$=""
1825 SA=PEEK(829):IFSATHENZZ$=" not"
1830 O$=VI$+" is"+ZZ$+" available":GOSUB30:RETURN
1835 IFSL<1THENRETURN
1840 O$="Current board:"+SU$(VI):GOSUB30
1845 GOSUB35:R$="{blue}Select msg. base<?>=:>":GOSUB40:GOSUB100
1850 IFI$=G$THENRETURN
1855 IFVAL(I$)>NSORVAL(I$)<0ORI$="?"THENGOSUB1865:GOTO1845
1860 GOTO1895
1865 O$="{yellow}{clear}{down}{reverse on}The other boards":GOSUB30:GOSUB35
1870 O$="{reverse on}{pink} #{space*3}msgs{space*2}name ":GOSUB30:GOSUB35:I=0:FORI=0TONS
1875 IFSL>=FJ(I)THENO$="{cyan}{reverse on}["+MID$(STR$(I),2)+"]{reverse off}{green}":IFI<10THENO$=O$+" "
1880 A$="{space*2}":IFRQ(I)>9THENA$=" "
1885 IFSL>=FJ(I)THENO$=O$+" {reverse on}["+MID$(STR$(RQ(I)),2)+"]{reverse off}"+A$+SU$(I):GOSUB30
1890 NEXT:RETURN
1895 IFSL<FJ(VAL(I$))THENGOSUB1865:GOTO1845
1900 VI=INT(VAL(I$)):SU$="."+STR$(VI):NM=RQ(VI):MN=RW(VI)
1905 IFVI=0THENSU$=""
1910 O$="{cyan}Now entering:"+SU$(VI):GOSUB30:RETURN
1915 GOSUB520:SYS52685
1920 GOSUB25:OPEN15,DA,15,DW$:PRINT#15,"s0:stats":OPEN8,DA,2,"0:stats,s,w"
1925 IFNA$=""THENNA$=LC$
1930 PRINT#8,CL:PRINT#8,SN$:PRINT#8,VI$:PRINT#8,DA$:PRINT#8,DR:PRINT#8,ED","EM%
1935 PRINT#8,NU","MU%:PRINT#8,DA","DK","DC","DD","DF
1936 PRINT#8,DW$:PRINT#8,DX$:PRINT#8,DY$:PRINT#8,DZ$
1940 PRINT#8,NS","LB","UD
1945 I=0:FORI=0TONS:PRINT#8,RQ(I);:PRINT#8,","RW(I)","FJ(I)","SU$(I)
1946 PRINT#8,ZO(I)","ZD$(I):NEXT
1950 I=1:FORI=1TOLB:PRINT#8,AJ(I)","BJ(I)","CJ$(I):PRINT#8,LZ(I)","LD$(I):NEXT
1952 I=1:FORI=1TOUD:PRINT#8,DZ(I)","DO(I)","UD$(I):PRINT#8,DU(I)","DG$(I):NEXT
1955 PRINT#8,OA$:PRINT#8,OL$:PRINT#8,NA$:PRINT#8,TM$
1960 GOSUB25:RETURN
1965 GOSUB215:GOSUB520:INPUT#8,CL,SN$,VI$,DA$,DR
1970 INPUT#8,ED,EM%,NU,MU%,DA,DB,DC,DD,DF
1971 INPUT#8,DW$:INPUT#8,DX$:INPUT#8,DY$:INPUT#8,DZ$
1974 INPUT#8,NS,LB,UD:A=NS+10:DIMRQ(A)
1975 DIMRW(A):DIMFJ(A):DIMSU$(A):DIMZO(A):DIMZD$(A):A=LB+10
1976 DIMAJ(A):DIMBJ(A):DIMCJ$(A):DIMLZ(A):DIMLD$(A):A=UD+10
1977 DIMUD$(A):DIMDO(A):DIMDU(A):DIMDG$(A):DIMDZ(A)
1980 DIMRJ(DB):DIMSJ(DB):DIMTJ$(DB):I=0:FORI=0TONS
1985 INPUT#8,RQ(I),RW(I),FJ(I),SU$(I):INPUT#8,ZO(I),ZD$(I):NEXT:I=1:FORI=1TOLB
1990 INPUT#8,AJ(I),BJ(I),CJ$(I):INPUT#8,LZ(I),LD$(I):NEXT:I=1:FORI=1TOUD
1991 INPUT#8,DZ(I),DO(I),UD$(I):INPUT#8,DU(I),DG$(I):NEXT
1992 INPUT#8,OA$:INPUT#8,OL$
1993 INPUT#8,LC$:TC$="":I=1:FORI=1TO8
1995 GET#8,A$:TC$=TC$+A$:NEXT:NM=RQ(0):MN=RW(0):DIMAR$(101):CLOSE8
2000 DE=DA:CZ=1
2005 DK=DB:RETURN
2010 RE=1:R$="{cyan}Password=:>":GOSUB40:P$=I$:IFI$=G$GOTO2030
2015 O$="{yellow}{reverse on}Checking userlog-":GOSUB30
2020 GOSUB90:OL=0:R=UN+1:GOSUB5455:NA$=ZA$:SL=ZG:GOSUB165
2025 IFPEEK(828)=3ORP$=ZC$GOTO2035
2030 NA$="":SL=0:OL=0:GOSUB25:RETURN
2035 NA$=ZA$:PA$=ZC$:SL=ZG:MW=ZH:LO$=ZW$:YC$=ZX$:YL$=ZY$
2040 YX$=ZZ$:CX=ZD:REM W4%=W1%:W5%=W2%:W6%=W3%
2045 R=UN+1:GOSUB4260
2046 PRINT#8,NA$","PA$","SL","MW","DA$","YC$","YL$","YX$","CL","W4%","W5%","W6%
2055 OL=1:GOSUB25:RETURN
2065 GOSUB180:GOSUB520:PRINT#8,"Logoff caller #:"+STR$(CL)+" - User #:";
2070 PRINT#8,U$:PRINT#8,"Logon:"+LT$+"{space*2}Logoff:";:PRINT#8,TM$:PRINT#8:CLOSE8:RETURN
2075 GOSUB90:R=FU+1:GOSUB5455:FU$=ZA$:QW=ZH:GOSUB25:IFFU=1ANDQW<15THENRETURN
2080 IFQW>2THENQW=-1:RETURN
2085 IFPBTHENPB=0:O$="Auto-reply to:"+FU$:GOSUB30:RETURN
2090 O$="Mail to:"+FU$:GOSUB30:R$="Correct?:":RP=1:GOSUB40
2095 GOSUB5095:IFI$<>"y"THENQW=-2
2100 RETURN
2105 GOSUB90:R=FU+1:GOSUB5455:R=FU+1:GOSUB4260:ZH=QW:GOSUB45:GOSUB25:RETURN
2110 IFSL>0ORNW=1GOTO280
2115 IFPEEK(841)=2THENO$="{reverse on}{red}New users not accepted right now.":GOSUB30:GOTO280
2120 C3=0:AK=1:YI=0:AN=0:GOTO2340
2125 GOSUB6000:DE=DA:FT$="app":GOSUB1465:IFYI=0THENYI=NU+1
2130 O$="NOTE:passwords utilize":GOSUB30
2135 O$="UPPER and lower case.":GOSUB30:GOSUB35
2140 R$="{yellow}Name :":GOSUB40:IFI$=G$GOTO280
2145 IFLEN(I$)<3THENO$="Too short!":GOSUB30:GOTO2140
2150 GOSUB610:I1$=SC$:R$="{red}Location{space*2}:":GOSUB40:GOSUB2330:I5$=SC$
2155 R$="{blue}Email{space*2}:":GOSUB40:GOSUB2330:I6$=SC$
2160 R$="{orange}Computer type(9chars max)=>":GOSUB40:I$=LEFT$(I$,9)
2165 GOSUB2330:I4$=SC$
2185 OL=1:R$="{green}Password under 10 chars=:>":GOSUB40:GOSUB610
2190 I2$=SC$:IFLEN(I2$)>9ORI2$=G$GOTO2185
2195 I1$=LEFT$(I1$,25):I5$=LEFT$(I5$,25):GOSUB35
2200 O$="{cyan}Your name=:>"+I1$:GOSUB30:O$="{blue}Password==:>"+I2$
2205 GOSUB30:O$="{purple}Location==:>"+I5$:GOSUB30
2210 O$="{red}Email Addr:>"+I6$:GOSUB30:O$="{brown}Computer==:>"+I4$
2215 GOSUB30:R$="{yellow}Correct?:":GOSUB40:GOSUB95:GOSUB5095
2220 IFI$<>"y"GOTO2140
2225 BP$=DA$:IFAN=1GOTO2235
2230 O$="{yellow}{reverse on}Checking for duplication.":GOSUB30:UA=1:GOSUB2295
2235 GOSUB25:GOSUB90:R=YI+1:GOSUB4260:GOSUB4260:ZZ=0:I3=PEEK(846)
2240 PRINT#8,I1$","I2$","I3",0,"DA$","I4$","I5$","I6$","ZZ",0,1,0"
2255 GOSUB25:IFAN=1GOTO2280
2260 GOSUB35:NW=1:O$="{yellow}{reverse on}Don't forget it!":GOSUB30
2265 O$="At the logon prompt enter":GOSUB30
2270 O$="your number and password.":GOSUB30:GOSUB35
2275 O$="{yellow}Your logon code=:>{red}"+STR$(YI):GOSUB30
2280 IFNU<MU%ANDC3=0THENNU=NU+1
2285 IFAN=1THENRETURN
2290 SYS52679:GOTO3725
2295 GOSUB90:I$=I1$:B$=LEFT$(I$,1):YA$=I$:R=2
2300 R=R+1:GOSUB4260:GET#8,A$
2305 IFA$=B$THENK7%=1:GOSUB5455:I$=ZA$:IFI$=YA$GOTO2320
2310 GOSUB175:IFR<NUGOTO2300
2315 GOSUB25:GOSUB35:RETURN
2320 GOSUB25:GOSUB35:O$="{red}{reverse on}Name exists!":GOSUB30:GOSUB35
2325 O$=I1$+" - ID#"+STR$(R-1):GOSUB30:GOTO280
2330 IFLEN(I$)<3THENI$="."
2335 GOSUB610:RETURN
2340 O$="Searching for an opening...hold on.":GOSUB30:GOSUB90
2345 R=2
2350 R=R+1:GOSUB4260:GET#8,A$
2355 IFA$="e"THENK7%=1:GOSUB5455:IFZA$="empty"THENYI=R-1:C3=1:GOSUB25:GOTO2125
2360 GOSUB175:IFR<NUGOTO2350
2365 GOSUB25:GOSUB35
2370 IFNU>=MU%THENO$="{reverse on}{yellow}No openings{sh space}available. Please try later.":GOSUB30:GOTO280
2375 GOTO2125
2380 C=0:BS=0:AB=0:T=TI:I$="":D=PEEK(840):IFR$=""GOTO2415
2385 POKE849,0:I=1:FORI=1TOLEN(R$):A=ASC(MID$(R$,I,1)):POKE52704,A:SYS53076
2390 IFA>127ANDA<160ORA<32GOTO2400
2395 C=C+1
2400 SYS52962:NEXT:IFMQ=0GOTO2415
2405 POKE849,0:POKE52704,163:PRINT"{yellow}":IFD<>1THENPRINT#5,"{yellow}"
2410 I=1:FORI=1TOC:SYS53076:SYS52962:NEXT:PRINT"{up}{cyan}";:IFD<>1THENPRINT#5,"{up}{cyan}";
2415 C=0:SYS53160
2420 R$="":SYS862
2425 IFD<>1THENGOSUB465:IFTI-T>5000THENSYS52673:GOSUB3570:GOSUB590:CLR:GOTO15
2430 POKE252,5:SYS50687:A=PEEK(251):IFA>0THENB=A:GOTO2445
2435 POKE252,0:SYS50687:C=PEEK(251):IFC=0GOTO2425
2440 A=C:B=C
2445 IFA=133ANDC<>133ANDSL>0THENGOSUB5625:RP=1
2450 IFA<5ORA=6ORA=10ORA=11ORA=19ORA=22GOTO2430
2455 IFA=8ORA=20GOTO2635
2460 IFA=13THENRP=0:GOTO2725
2465 IFLW=0GOTO2515
2470 IFA=15ANDSL>9THENGOSUB5340:RETURN
2475 IFA=24THENAR$(LS%)=I$:AK=1:RETURN
2480 IFA=12ANDMQ=1ANDLEN(I$)<253THENO$="{ct n}{clear}":GOSUB30:I$=I$+"{ct n}{clear}"
2485 IFA=21ANDMQ=1ANDLEN(I$)<253THENO$=CHR$(142)+"{clear}":GOSUB30:I$=I$+CHR$(142)+"{clear}"
2490 IFA=26ANDLS%>1THENAL=1:LS%=LS%-1:O$="{reverse on}re-enter line-":GOSUB30:GOTO2630
2495 IFA=23ANDFM=0THENFM=1:O$="{reverse on}word wrap on":GOSUB30:I$="":GOTO2420
2500 IFA=23ANDFM=1THENFM=0:O$="{reverse on}word wrap off":GOSUB30:I$="":GOTO2420
2505 IFA=25ANDLS%>1THENAR$(LS%)=I$:AK=2:RETURN
2510 IFI$="/e"ORI$="/E"THENI$="":AK=1:RETURN
2515 IFCGOTO2565
2520 SYS50725:A=PEEK(251):IFA=0GOTO2425
2525 IFLEN(I$)>36ANDFM=1ANDA<>32THENI$=I$+CHR$(A):GOTO5405
2530 IFLEN(I$)>253THENT=TI:GOTO2720
2535 IFRETHENB=42
2540 I$=I$+CHR$(A):IFD<>1ANDMQ=0ANDC<>0THENPRINT#5,CHR$(PEEK(B+52000));:GOTO2546
2545 IFD<>1THENPRINT#5,CHR$(B);
2546 IFC=0THENPRINTCHR$(A);
2550 IFCTHENPRINTCHR$(C);
2555 SYS862:IFRPTHENRP=0:GOTO2730
2560 GOTO2425
2565 IFC=133THENGOSUB2790
2570 IFC=134THENNZ=0:GOTO280
2575 IFC=135THENSA=1-PEEK(829):POKE829,SA:IFSA=0THENPRINT"{reverse on}chat on-":GOTO2420
2580 IFSA=1ANDC=135THENPRINT"{reverse on}chat off-":GOTO2420
2585 IFC=136THENAB=1:RETURN
2590 IFC=137THENGOSUB4760:GOTO2420
2595 IFC=138GOTO3950
2600 IFC=139THENINPUT"note";X$:GOSUB125:PRINT#5,X$:GOTO2420
2605 IFC=140ANDD=1THENGOSUB3525:GOSUB1915:CLR:GOTO15
2610 IFC=140THENGOSUB3570:GOSUB590:CLR:GOTO15
2625 GOTO2520
2630 RETURN
2635 IFLEN(I$)<1ANDNZ=1ANDLS%>1THENLS%=LS%-1:I$=AR$(LS%)
2640 IFRIGHT$(I$,1)=CHR$(13)THENLS%=LS%+1:I$="":GOTO2425
2645 IFLEN(I$)<1ANDNZ=1ANDLS%>1GOTO2635
2650 IFLEN(I$)<1GOTO2425
2655 A=0:B=0:A=ASC(RIGHT$(I$,1)):IFA=20ANDMQ=1GOTO2705
2660 IFMQ=0THENB=8:PRINTCHR$(20);:GOTO2710
2665 IFA=145THENB=17:GOTO2710
2670 IFA=17THENB=145:GOTO2710
2675 IFA=29THENB=157:GOTO2710
2680 IFA<21ANDA<>5GOTO2711
2685 IF(A>129)AND(A<145)GOTO2711
2690 IFA=157THENB=29:GOTO2710
2695 IFA=5ORA=28ORA=30ORA=31THENB=A:GOTO2710
2700 IFA>148ANDA<160ORA=129THENB=A:GOTO2710
2705 B=20
2710 PRINTCHR$(B);:IFD<>1THENPRINT#5,CHR$(B);
2711 I$=LEFT$(I$,LEN(I$)-1)
2715 GOTO2420
2720 I$=I$+CHR$(A)
2725 PRINTCHR$(A);:IFD<>1THENPRINT#5,CHR$(B);
2730 IFD<>1ANDLF=1THENPRINT#5,"{down}"
2735 IFQA=1ANDLEN(I$)<254THENI$=I$+CHR$(13)
2740 IFI$=""THENI$=G$
2745 RE=0:IFLF=1ANDD<>1THENPRINT#5,CHR$(10);:SYS862
2750 RETURN
2755 IFSL>7GOTO2770
2760 IFSL<2THENXZ=XZ+1:RETURN
2765 IFPEEK(829)THENO$="{red}{reverse on}"+NA$+", I'm busy right now!":GOSUB1075:XZ=XZ+1:RETURN
2770 POKE53280,3:O$="{reverse on}{red} Paging The Sysop... ":GOSUB30:PRINT
2775 PRINT"{purple}"+VI$+" press {reverse on}RETURN{reverse off} to answer{yellow}":POKE54296,15:I=0
2780 FORI=0TO5:GETA$:IFA$=G$THENI=5:GOTO2790
2785 GOSUB2825:NEXT:POKE54296,0:RETURN
2790 POKE53280,0:ZV$=TI$:GOSUB35:GOSUB35
2795 O$="{clear}Sysop engaged chat mode{ct g}":GOSUB30:GOSUB35
2800 O$="Can I help you "+NA$+"?":GOSUB30:GOSUB35:POKE54296,0:XZ=0
2805 SYS862
2810 NZ=1:GOSUB2430:IFABTHENAB=0:GOTO2820
2815 I$="":T=TI:GOTO2810
2820 I$="":TI$=ZV$:NZ=0:RETURN
2825 SYS52587:XX=0:FORXX=0TO1550:NEXT:RETURN
2830 IFSL<BJ(1)THENRETURN
2835 O$="{clear}{down}{yellow}{space*11}{reverse on}The libraries{purple}":GOSUB30:GOSUB35
2840 O$="{reverse on} #{sh space} files{space*2}name ":GOSUB30:GOSUB35:I=1:FORI=1TOLB
2845 IFSL>=BJ(I)THENO$="{cyan}{reverse on}["+MID$(STR$(I),2)+"]{reverse off}{green}":IFI<10THENO$=O$+" "
2850 A$="{space*2}":IFBJ(I)>9THENA$=" "
2855 IFSL>=BJ(I)THENO$=O$+" {reverse on}["+MID$(STR$(AJ(I)),3)+"]{reverse off}"+A$+CJ$(I):GOSUB30
2860 NEXT:GOSUB35:R$="{blue}Select library{cyan}{reverse on}[0=abort]{reverse off}{blue}=:>":GOSUB40
2865 GOSUB100:IFI$=G$THENRETURN
2870 SX=INT(VAL(I$)):IFSX<1ORSX>LBTHENRETURN
2875 IFSL<BJ(SX)THENRETURN
2880 IFAJ(SX)=0ANDSL<10THENO$="{red}{reverse on}No files!":GOSUB30:GOTO2830
2885 GOSUB5815:DE=LZ(SX):FT$=" "+STR$(SX):GOSUB1470:GOSUB70
2890 IFSL>9THENO$="{purple}[L] to add a file":GOSUB30
2895 R$="{blue}Select file{cyan}{reverse on}[0=abort]{reverse off}{blue}=:>":GOSUB40:O$="{ct n}":GOSUB30
2900 GOSUB100:IFI$=G$GOTO2835
2905 IFI$="l"ANDSL>9THENGOSUB5540:GOTO2835
2910 YX=INT(VAL(I$)):IFYX<1ORYX>AJ(SX)THENRETURN
2915 FT$=FT$+"."+STR$(YX):GOSUB5815:DE=LZ(SX):GOSUB1470:GOTO2885
2917 REM UD AREA
2920 Y%=0:IFSL<PEEK(837)THENGOSUB105:RETURN
2921 IFSL<DO(CZ)THENGOSUB105:RETURN
2925 A$="*":IFBFTHENBF=0:A$=""
2930 GOSUB25:NQ=-1
2935 GOSUB5820:OPEN15,DU(CZ),15:OPEN8,DU(CZ),0,"$0:"+A$
2945 GOSUB4270:IFEN>19THENGOSUB25:RETURN
2950 IFP1=0THENO$="{clear}{down}{yellow} Download directory:{light blue}"+UD$(CZ):GOSUB30
2955 CC=1
2960 IFP1=0THENGOSUB35:O$="{brown}{reverse on} #{space*2}BLK{space*2}TYPE{space*2}TIME{space*3}FILE NAME {light blue}":GOSUB30:GOSUB35
2965 POKE252,8:SYS850:SYS850
2970 SYS850:SYS850:SYS850:A%=PEEK(251):SYS850:B%=PEEK(251):C%=0:NQ=NQ+1
2975 IFA%THENC%=A%:A%=0
2980 IFB%THENC%=C%+B%*256:B%=0
2985 E$=STR$(C%):Z$="{space*3}":IFLEN(E$)=3THENZ$="{space*2}"
2990 IFLEN(E$)=4THENZ$=" "
2995 TT=C%/255*10:TT$=MID$(STR$(TT),2):TT$=LEFT$(TT$,3):X$="{space*2}"
3000 IFLEN(TT$)=2THENX$=" "
3005 IFLEN(TT$)=3THENX$=""
3010 SYS850:B%=PEEK(251):IF(ST)GOTO3115
3015 D$="":IFB%<>34THENB%=0:GOTO3010
3020 SYS850:B%=PEEK(251):IFB%<>34THEND$=D$+CHR$(B%):GOTO3020
3025 SYS850:B%=PEEK(251):IFB%=32THENB%=0:GOTO3025
3030 C$=""
3035 C$=C$+CHR$(B%):SYS850:B%=PEEK(251):IFB%GOTO3035
3040 IF(ST)=0THENJ=0
3050 I=1:FORI=1TO3:IFMID$(D$,I,1)="@"ANDSL<7THENNQ=NQ-1:AB=1
3055 IFMID$(D$,I,1)="^"ANDSL<10THENNQ=NQ-1:AB=1
3060 NEXT:IFABTHENAB=0:GOTO3110
3065 IFNQ=0GOTO3105
3070 IFNQ=K1ANDY%=1THENY%=0:P$=D$+","+LEFT$(C$,1):GOSUB25:RETURN
3075 IFP1GOTO3110
3080 A$="{space*3}":IFNQ>9ANDNQ<100THENA$="{space*2}"
3085 IFNQ>99THENA$=" "
3090 O$="{cyan}{reverse on}"+MID$(STR$(NQ),2)+"{reverse off}"+A$+"{light gray}"+MID$(STR$(C%),2)
3095 O$=O$+Z$+" {pink}["+LEFT$(C$,3)+"]{reverse off} {cyan}["+TT$+"]{reverse off} "+X$+"{light blue} "+D$
3100 GOSUB30
3105 IFABTHENNQ%=NQ:NR%=0:GOSUB25:RETURN
3110 IFJ=0THENJ=1:A%=0:B%=0:C$="":GOTO2970
3115 IFP1THENGOSUB25:RETURN
3120 GOSUB35:O$="{cyan}{reverse on}"+MID$(STR$(C%),2)+" blocks free":GOSUB30:GOSUB25
3125 NQ%=NQ:IFNR%THENNR%=0:RETURN
3130 I$="":IFSL>9THENR$="Scratch/Re-name>=:>":GOSUB40:GOSUB95
3135 IFI$="r"THENGOSUB5580:GOTO3130
3140 IFI$="s"THENAB=0:UZ=1:Y%=1:GOSUB3455:IFAB<>1GOTO3150
3145 GOTO3155
3150 P$=LEFT$(P$,LEN(P$)-2):GOSUB5820:OPEN15,DU(CZ),15,"s0:"+P$
3152 GOSUB25:GOTO3130
3155 IFI$="p"THENAB=0:GOSUB3395:IFAB<>1GOTO3165
3160 RETURN
3165 GOSUB20:PRINT#15,"r0:"+I$+"="+P$:GOSUB25:O$="{reverse on}Private.":GOSUB30
3170 GOTO3130
3180 RETURN
3185 IFSL<PEEK(837)THENGOSUB105:RETURN
3186 IFSL<DO(CZ)THENGOSUB105:RETURN
3190 GOSUB70:IFPEEK(843)=0GOTO3205
3195 GOSUB110
3200 IFA<1ANDSL<=PEEK(681)THENO$="Don't be a leech!!!":GOSUB30:GOSUB3510:GOSUB1915:CLR:GOTO15
3205 UZ=0:Y%=1:GOSUB3375:IFABTHENO$="{f5*2}{reverse on}Ended":GOSUB30:GOSUB65:RETURN
3210 O$="{reverse on}Enter recieve mode-":GOSUB30
3215 O$="{reverse on}or hit return to abort":GOSUB30:J=1:Z=1:GET#5,A$
3220 GOSUB125
3225 J=J+1:GET#5,A$:IFJ>20000ORZ>7ORA$=G$ORPEEK(197)<>64THENRETURN
3230 GOSUB465:IFA$=""GOTO3225
3235 IFA$<>"g"ANDA$<>"G"THENZ=Z+1:GOTO3225
3240 PRINT"{clear}{down*2}{light blue} D/L:";:PRINTP$;:PRINT"{down}":SYS53160:POKE53269,0
3245 IFPEEK(834)<>2THENGOSUB180:PRINT#8," D/L:";:PRINT#8,P$:CLOSE8:GOSUB5820
3250 GOSUB25:OPEN15,DU(CZ),15:OPEN2,DU(CZ),0,"0:"+P$+",r":SYS49173:POKE51227,TY
3255 SYS49164:GOSUB465:IFPEEK(512)=1GOTO3270
3260 SYS49173:POKE51224,255:SYS49158:CLOSE2:W6%=W6%+1:R=UN+1:GOSUB90
3265 GOSUB4260:GOSUB2045:GOSUB25
3270 GOSUB25:GOSUB5610:GOTO3185
3275 IFSL<PEEK(837)THENGOSUB105:RETURN
3276 IFSL<DO(CZ)THENGOSUB105:RETURN
3280 A2=DB:UZ=1:GOSUB3375:IFABTHENRETURN
3285 K1=0:P1=1:BF=1:DH=DB:DB=A2:GOSUB2925:P1=0:DB=DH
3290 IFC%<30THENO$="Disk full!":GOSUB30:RETURN
3295 O$="Enter send mode-":GOSUB30
3300 J=1:Z=1:F$=TI$
3305 J=J+1:GET#5,A$:IFA$=G$ORJ>20000ORZ>7ORPEEK(197)<>64THENRETURN
3310 GOSUB465:IFA$=""GOTO3305
3315 IFA$<>"g"ANDA$<>"G"THENZ=Z+1:GOTO3305
3320 IFPEEK(842)=1THENP$="^"+P$
3330 PRINT"{clear}{down*2}{light blue} U/L:";:PRINTP$;:PRINT"{down}":SYS53160
3335 IFPEEK(834)<>2THENGOSUB180:PRINT#8," U/L:";:PRINT#8,P$:CLOSE8
3340 SYS49173:SYS49161:IFPEEK(51224)=0ORPEEK(51227)=0ORPEEK(512)=1THENRETURN
3345 T$=","+MID$(TY$,PEEK(51227),1)+",w":GOSUB25:GOSUB20:GOSUB5820
3350 OPEN2,DU(CZ),2,"0:"+P$+T$:SYS61310:REM OPEN15,DU(CZ),15:GOSUB4270
3355 REM IFEN>19THENO$="aborted":GOSUB30:GOSUB25:RETURN
3360 SYS49173:SYS49155:CLOSE2:GOSUB125:GOSUB465:W5%=W5%+1:R=UN+1:GOSUB90
3365 GOSUB4260:GOSUB2045:GOSUB25:GOSUB35:CD=1
3370 O$="Upload recorded. Thank you!":GOSUB30:CD=0:TI$=F$:RETURN
3375 AB=0:GOSUB35:O$="{reverse on}NEW Punter protocol":GOSUB30
3380 O$="{reverse on}{green} Please {yellow} Lynx {green} multi-file programs!! ":GOSUB30
3385 O$="{red}{reverse on}COMMODORE KEY aborts during transfer.":GOSUB30
3390 GOSUB35:IFUZ=0GOTO3445
3395 GOSUB35:R$="{blue}File name=:>":GOSUB40:GOSUB5095:IFI$=G$THENAB=1:RETURN
3400 GOSUB610
3405 P$="":I$=LEFT$(I$,16):I=1:FORI=1TOLEN(I$):A$=MID$(I$,I,1)
3410 IFA$="*"ORA$="?"ORA$="="ANDSL<10THENQQ=1
3415 P$=P$+A$:NEXT:IFQQTHENQQ=0:O$="{red}{reverse on}No wild cards.":GOSUB30:GOTO3395
3420 RETURN
3445 IFK1<>0ORAB=1GOTO3460
3450 O$="Separate multiple files with colon[:]":GOSUB30
3455 R$="{blue}Enter file number=:>":GOSUB40
3460 K1=INT(VAL(LEFT$(I$,3))):IFI$=G$ORAB=1ORK1<1ORNQ%=1THENAB=1:RETURN
3465 O$="{reverse on}{cyan}Looking up file"+STR$(K1):GOSUB30:AB=0:P1=1:GOSUB2925
3470 P1=0
3475 IFK1<>NQORY%=1THENO$="{red}{reverse on}File not found.":GOSUB30:AB=1:K1=0:RETURN
3480 IFUZTHENUZ=0:RETURN
3485 GOSUB35:O$="{light blue}Download time "+TT$+" min.":GOSUB30
3490 O$=RIGHT$(P$,1):TY=1:IFO$="s"THENTY=2
3495 GOSUB35
3500 O$=LEFT$(P$,LEN(P$)-2)
3505 O$="Filename:{f1*2}"+O$:GOSUB30:GOSUB35:RETURN
3510 CLOSE8:IFPEEK(828)=3GOTO3530:CLOSE15
3515 CD=2:GOSUB6000:FT$="end":DE=DA:GOSUB1465:IFABGOTO3525
3520 FT$="data.file3":GOSUB6000:DE=DA:GOSUB1465
3525 GOSUB3570:IFPEEK(834)<>2THENGOSUB2065
3530 PRINT:PRINT"maint":PRINT"initializing"
3535 OPEN15,DA,15,"i0":CLOSE15:OPEN15,DB,15,"i0:":CLOSE15:OPEN15,DC,15,"i0"
3540 CLOSE15:U=0:FORU=0TONS
3545 IFRQ(U)>RW(U)THENMK=1:ZP=1:VI=U:NM=RQ(VI):MN=RW(VI):SU$="."+STR$(VI)
3550 IFRQ(U)>RW(U)THENIFVI=0THENSU$=""
3555 IFRQ(U)>RW(U)THENGOSUB1040
3560 NEXTU:IFZP=1THENZP=0:GOTO3540
3565 RETURN
3570 CD=2:GOSUB35:O$="{red}{reverse on}A.M.F!":GOSUB30:B=32
3580 POKE56577,0:POKE56579,38
3585 GOSUB5310
3586 POKE56577,PEEK(56577)OR16
3590 GOSUB120:PRINT#5,"+++";:GOSUB65:PRINT#5,"ath":GOSUB65:PRINT#5,"ats7=255a"
3591 GOSUB65:RETURN
3605 J=J+1:IFJ>55THENGOSUB3570:CLR:GOTO15
3620 GOSUB5310:K=1:GOSUB125
3625 GOSUB465:K=K+1:GOTO3640
3630 IFK<110GOTO3625
3635 GOTO3605
3640 GOSUB35:CD=1:O$="2400 baud{ct g}{ct j}":GOSUB30:CD=0
3645 GOSUB6000:FT$="open":DE=DA:GOSUB1465:RETURN
3655 GOSUB5310:GOSUB125:GOSUB35:CD=1:O$="detecting you...":GOSUB30:CD=0
3660 GOTO3620
3665 PRINT"{clear}";
3670 DA=PEEK(835):TL=PEEK(836)*100:TY$="psp":P2=6
3675 GU=0:G$=CHR$(13):DE=8:LF=1:MQ=1:IFPEEK(828)=2THENJ=1:GOSUB3655
3680 TI$="000000":LT=TI
3685 IFPEEK(828)=3THENUN=1:GOSUB2020:CL=CL+1:LF=0:GOTO3885
3690 MQ=1:O$="{ct n}":GOSUB30:MQ=0:GOSUB5280:GOSUB35:GOSUB35
3695 O$="{cyan}are you in":GOSUB30:GOSUB35
3700 R$="{red}C{purple}B{blue}M {yellow}GRAPHICS{blue} [G] or hit RETURN=:>":MQ=0:GOSUB40
3705 GOSUB95
3710 IFI$="G"ORI$="g"THENMQ=1:LF=0:O$="{yellow}{reverse on}G{red}r{purple}a{light blue}p{dark gray}h{brown}i{light green}c{pink}s{white} on-":GOSUB30:GOTO3720
3715 MQ=0:O$="No graphics-ASCII on":LF=1:GOSUB30
3720 GOSUB150:LT=TI:GOSUB520:LT$=TM$
3725 GU=0:J=0:GOSUB35
3730 J=J+1:IFJ>3THENSYS52673:GOSUB3525:CLR:GOTO15
3735 IFPEEK(841)=0ORNW=1THENR$="{light blue}Enter Logon code=:>":GOSUB40:U$=I$:GOTO3755
3740 R$="{light blue}Logon code or 'guest'=:>":GOSUB40:U$=I$:GOSUB95
3745 IFI$=G$GOTO3730
3750 IF(I$="g"ORI$="G")ANDNW<>1THENSL=0:NA$="guest":GOSUB165:LO$="Today":GOTO3765
3755 U$=LEFT$(U$,3):UN=VAL(U$):IFUN>NUORUN<1THENGOSUB230:GOTO3730
3760 GOSUB2010:IFOL<>1THENGOSUB105:GOTO3730
3765 GOSUB35:CD=1
3770 IFSL=0ORSL>.5THENO$="{clear}{green}"+VI$+" {cyan}Welcomes {yellow}"+NA$:GOSUB30
3775 IFSL=.5THENO$="{clear}"+NA$+" {red}{reverse on}your access is restricted!":GOSUB30
3780 IFSL=.1THENGOSUB25:O$=NA$+", {white}{reverse on}DON'T CALL{sh space}BACK!!!":GOSUB30
3785 IFSL=.1THENJ=6:GOTO3730
3790 IFNA$="guest"THENGU=1
3795 GOSUB35:O$="{reverse on}{light gray}Your level is {reverse off}"+STR$(SL)+" ":GOSUB30
3800 O$="{reverse on}{pink}Last on{space*7}{reverse off} "+LO$:GOSUB30
3805 O$="{reverse on}{blue}Today is{space*6}{reverse off} "+DA$:GOSUB30
3810 O$="{reverse on}{cyan}Caller #{space*6}{reverse off}"+STR$(CL):CL=CL+1:GOSUB30:GOSUB520
3815 O$="{reverse on}{light green}Connected at{space*2}{reverse off} "+TM$:GOSUB30
3820 O$="{reverse on}{green}Last caller{space*3}{reverse off} "+LC$+" at "+TC$:GOSUB30:GOSUB35
3825 GOSUB645
3870 CD=0:FT$="welcome":IFGUTHENFT$="guest welcome"
3871 GOSUB6000:DE=DA
3875 GOSUB1460:CD=0
3880 IFGUTHENGOSUB35:O$="{yellow}Please read the HELP and INFO files":GOSUB30:GOTO3905
3885 IFMW=0THENGOSUB35:O$="{light blue}"+NA$+"{blue}, You have no mail.":GOSUB30:GOSUB35:GOTO3900
3890 IFMW>0THENO$="{light green}"+NA$+"{green}, You have"+STR$(MW)+" letters waiting.":GOSUB30
3895 IFMW>0THENO$="{blue}Opening your letter-":GOSUB30:GOSUB1560
3900 IFUN=1ORPEEK(828)=3THENPOKE831,0
3905 GOTO280
3910 GOSUB90:GOSUB5455:GOSUB25
3915 IFZH<1GOTO3930
3920 ED=ED-ZH:GOSUB1920:ZH=0:O$="{reverse on}Mail deleted.":GOSUB30
3925 GOSUB6010:OPEN15,DC,15,"s0:"+STR$(R-1)+"-*":GOSUB25
3930 IFY=0THENRETURN
3935 GOSUB90:GOSUB4260:PRINT#8,"empty,.,0,0,.,.,.,.,0,0,0,0":GOSUB25
3940 Y=0:RETURN
3945 IFPEEK(834)<>2THENGOSUB180:PRINT#8,"CMD access":CLOSE8
3950 RL=0:O$="{green}":GOSUB30
3955 GOSUB35:R$="{cyan}{reverse on}[Last Read"+STR$(US)+"]{reverse off}{blue} cmd =:>":GOSUB40
3960 GOSUB5095:GOSUB100:O$="{ct n}":GOSUB30:Y=0:IFI$=G$GOTO280
3965 A$=I$:IFA$="s"THENGOSUB1680
3970 IFA$="a"ANDNU<MU%THENYI=NU+1:YI$=STR$(YI):AN=1:GOSUB2140
3975 IFA$="#"THENGOSUB4590
3980 IFA$="b"THENGOSUB5225
3985 IFA$="cal"THENGOSUB680
3990 IFA$="r"THENGOSUB4070
3995 IFA$="w"THENGOSUB4990
4000 IFA$="rea"THENGOSUB5505:QP%=0
4005 IFA$="c"THENGOSUB4140
4010 IFA$="dat"THENGOSUB4245
4015 IFA$="val"THENGOSUB5520
4020 IFA$="dir"THENDH=DB:GOSUB4980:IFAB=0THENDB=A2:NR%=1:Y%=0:GOSUB2925:DB=DH
4025 IFA$="+"ANDUS>0THENUS=US+1:GOSUB4085:GOSUB4145
4030 IFA$="-"ANDUS>2THENUS=US-1:GOSUB4085:GOSUB4145
4035 IFA$="p"ANDPEEK(828)=3THENGOSUB4485
4040 IFA$="^"THENGOSUB4055
4045 IFA$="?"THENGOSUB6000:DE=DA:FT$="data.file4":GOSUB1470
4050 GOTO3955
4055 R$="Luzer# to delete=>":GOSUB40:GOSUB100:R=VAL(I$)+1
4060 IFR<0ORR>NU+1ORI$=G$THENRETURN
4065 I$="^":GOTO4160
4070 GOSUB35:R$="User#=:>":GOSUB40:GOSUB100
4075 IFUN<>1ANDVAL(I$)<2ORVAL(I$)<1THENAG=1:RETURN
4080 US=INT(VAL(I$))
4085 R=US+1:IFR<1ORR>NU+1THENGOSUB230:GOTO4070
4090 IFI$=G$THENAG=1:RETURN
4095 GOSUB90:GOSUB5455:GOSUB25:IFABTHENAB=0:RETURN
4100 O$="{cyan}User=>"+MID$(STR$(R-1),2):GOSUB30:O$="Name=====:> "+ZA$
4105 GOSUB30:O$="Password=:> "+ZC$:GOSUB30
4110 O$="Location=:> "+ZY$:GOSUB30:O$="E-Mail ==:> "+ZZ$
4115 GOSUB30:O$="Computer=:> "+ZX$:GOSUB30
4120 O$="Sec. level>"+STR$(ZG):GOSUB30:O$="Posted===:>"+STR$(W1%)
4125 GOSUB30:O$="Uploads==:>"+STR$(W2%):GOSUB30
4130 O$="Downloads:>"+STR$(W3%):GOSUB30:O$="mail=====:>"+STR$(ZH)
4135 GOSUB30:O$="Last on==:> "+ZW$:GOSUB30:RETURN
4140 GOSUB4070:IFAGTHENAG=0:RETURN
4145 IFUS>NUTHENRETURN
4150 R$="{yellow}{reverse on}Correct y/n <^>delete{reverse off}:":RP=1:GOSUB40:GOSUB35
4155 ZB$=ZA$:IFI$="y"THENRETURN
4160 IFI$="^"THENY=1:GOSUB3910:RETURN
4165 O$="{yellow}{reverse on}Press return for no change":GOSUB30
4170 V=0:R$="New name ====:>":GOSUB40:IFI$<>G$THENGOSUB610:ZA$=I$
4175 R$="New password=:>":GOSUB40:IFI$<>G$THENGOSUB610:ZC$=I$
4180 R$="New location=:>":GOSUB40:IFI$<>G$THENGOSUB610:ZY$=I$
4185 R$="New email{space*3}=:>":GOSUB40:IFI$<>G$THENGOSUB610:ZZ$=I$
4190 R$="New computer=:>":GOSUB40:IFI$<>G$THENGOSUB610:ZX$=I$
4195 R$="New sec. level:>":GOSUB40:IFI$<>G$THENZG=VAL(I$)
4200 R$="New Posted lvl:>":GOSUB40:IFI$<>G$THENW1%=VAL(I$)
4205 R$="New Upload lvl:>":GOSUB40:IFI$<>G$THENW2%=VAL(I$)
4210 R$="New Dwnld{space*2}lvl:>":GOSUB40:IFI$<>G$THENW3%=VAL(I$)
4215 Z3=LEN(ZA$+ZR$+ZE$+ZF$+ZC$)
4220 IFZ3>80THENO$="Shorten things up a bit!":GOSUB30:GOTO4170
4225 IFLEN(ZA$)>25ORLEN(ZY$)>25THENO$="Shorten name or location!":GOSUB30:GOTO4170
4230 R$="Delete mail [y/n]=:>":RP=1:GOSUB40
4235 IFI$="y"THENY=0:GOSUB3915
4240 GOSUB90:GOSUB4260:GOSUB45:GOSUB4270:GOSUB25:RETURN
4245 O$="Current date:"+DA$:GOSUB30:R$="New date:":GOSUB40
4250 IFI$=G$THENRETURN
4255 DA$=I$:RETURN
4260 RH=INT(R/256):RL=R-RH*256:PRINT#15,"p"+CHR$(98)+CHR$(RL)+CHR$(RH)+CHR$(2)
4265 RETURN
4270 INPUT#15,EN,EM$,ET,ES:IFEN>19THENO$=EM$:GOSUB35:GOSUB30
4275 RETURN
4280 REM WFC SCREEN
4295 IFPEEK(835)=8ORPEEK(835)=9GOTO4310
4300 IFPEEK(835)<>8THENPOKE829,0:INPUT"{red}{reverse on}Insert DATA disk(s) and hit return";A$
4305 POKE835,8:POKE839,0
4310 GOSUB1965
4315 SA=PEEK(829):A=PEEK(834):IFA=0THENA=1:POKE834,A
4320 IFA=1THENPS$="Stats to Disk"
4325 IFA=2THENPS$="Login log off"
4330 ZZ$="":IFSA=1THENZZ$=" Not{space*5}"
4335 POKE198,0:POKE53269,0:PRINT"{clear}{ct n}{cyan}";:PRINTDA$:NC=PEEK(830):I=1:FORI=1TO39
4340 PRINT"{cm @}";:NEXT:PRINT:PRINT"Callers{sh -}Quantity{sh -}Jerks {sh -}New{space*2}{sh -}"+ZZ$
4345 PRINT"Today{space*2}{sh -}Mail{space*4}{sh -}Booted{sh -}Users{sh -}Available":PRINTNC;:PRINTTAB(7);
4350 PRINT"{sh -}";:PRINTPEEK(831);:PRINTTAB(16);:PRINT"{sh -}";:PRINTPEEK(832);:PRINTTAB(23);:PRINT"{sh -}";
4355 PRINTPEEK(833);:PRINTTAB(29);:PRINT"{sh -}":I=1:FORI=1TO39:PRINT"{cm t}";:NEXT:PRINT
4360 PRINT"Total calls";:PRINTCL;:PRINTTAB(26);:PRINTPS$:CLOSE8
4362 GOSUB5310
4363 PRINT"Baud Rate: 2400":GOSUB25:GOSUB6000
4365 OPEN8,DA,2,"0:data.file1":SYS51232
4370 J=J+1:GOSUB4745:GETA$:IFA$=CHR$(13)THENPOKE828,3:POKE840,1:GOTO3665
4371 GET#5,NV$:IFNV$=CHR$(13)THENPOKE251,0:GOTO4930
4372 IFNV$="ring"ORNV$="RING"THENPOKE251,0:GOTO4930
4373 IFNV$="ring"+CHR$(13)THENPOKE251,0:GOTO4930
4374 IFNV$="RING"+CHR$(13)THENPOKE251,0:GOTO4930
4375 IFNV$="r"THENPOKE251,0:GOTO4930
4376 IFNV$="R"THENPOKE251,0:GOTO4930
4379 PRINT"{home}";:PRINTTAB(31);:PRINTTM$;:PRINT" "
4380 IFA$="{f3}"THENPOKE830,0:POKE831,0:POKE832,0:POKE833,0:GOTO4315
4385 IFA$="{f5}"THENGOSUB4460:POKE830,PEEK(830)-1:CLR:GOTO15
4390 IFA$="{f1}"THENSA=PEEK(829):SA=1-SA:POKE829,SA:GOTO4315
4395 IFA$="{f7}"THENZZ=PEEK(834):ZZ=1+ZZ:IFZZ>2THENZZ=1
4400 IFA$="{f7}"THENPOKE834,ZZ:GOTO4315
4410 SYS51339:IFPEEK(251)=0GOTO4930
4415 IFA$="{f6}"THENPOKE840,1:GOSUB680:POKE840,0:GOTO4315
4420 IFA$="{f2}"THENCLOSE15:OPEN15,DA,15,"v0":CLOSE15:GOTO4315
4425 IFA$="{f4}"THENPOKE840,1:GOTO3665
4430 IFA$="{f8}"GOTO4800
4435 IFJ=0GOTO4335
4440 IFJ<=1500GOTO4370
4445 J=-39000:GOSUB4455:GOTO4370
4450 GOTO4370
4455 PRINT"{clear}";:PRINTTAB(14);:PRINT"{green}{down}CMBBS v7.0":RETURN
4460 PRINT"{clear}Current date ";:PRINTDA$
4465 PRINT"Please enter New date":INPUTI$:IFLEN(I$)<6GOTO4465
4470 INPUT"Correct";B$:IFLEFT$(B$,1)="y"GOTO4480
4475 GOTO4465
4480 GOSUB610:DA$=I$:DA=PEEK(835):GOSUB1915:RETURN
4485 RETURN
4525 GOSUB35:O$="{yellow}Checking "+SU$(VI)+" for new msgs.":GOSUB30
4530 IFGU=1ORNW=1ORCX=0THENGOSUB240:XX=1:MS=0:GOSUB770:RETURN
4535 IFNM<1THENGOSUB245:RETURN
4540 GOTO4575
4545 GOSUB35:K=NM:GOSUB35
4550 IFK<1GOTO4570
4555 GOSUB5805:CLOSE8:OPEN8,ZO(K),2,"0:"+MID$(STR$(K),2)+SU$:INPUT#8,Z$
4560 IFVAL(Z$)<CXTHENXX=K+1:MS=K:GOSUB35:GOSUB770:RETURN
4565 GOSUB175:K=K-1:GOTO4550
4570 GOSUB35:GOSUB240:GOSUB25:XX=1:MS=0:GOSUB770:RETURN
4575 K=NM:GOSUB5805:CLOSE8:OPEN8,ZO(K),2,"0:"+MID$(STR$(K),2)+SU$:INPUT#8,Z$
4580 IFVAL(Z$)<CXTHENGOSUB245:GOSUB25:RETURN
4585 CLOSE8:GOTO4550
4590 GOSUB35:O$="[1] Change max. # Users-":GOSUB30
4595 O$="[2] max mail in system-":GOSUB30:GOSUB35:GOSUB235:GOSUB35
4600 GOSUB95:IFI$="1"GOTO4615
4605 IFI$="2"GOTO4640
4610 RETURN
4615 O$="Current # users:"+STR$(NU):GOSUB30
4620 O$="Max # Users:"+STR$(MU%):GOSUB30:R$="Max # of users=:>"
4625 GOSUB40:GOSUB100:A=VAL(I$):IFA<1THENRETURN
4630 IFA>MU%THENR=A:GOSUB90:GOSUB4260:PRINT#8,"hi":GOSUB4270:GOSUB25
4635 MU%=A:RETURN
4640 O$="Current mail:"+STR$(ED):GOSUB30:O$="Max mail:"+STR$(EM%)
4645 GOSUB30:R$="Max mail allowed:>":GOSUB40:GOSUB100:A=VAL(I$)
4650 IFA<1THENRETURN
4655 EM%=A:RETURN
4675 GOSUB25:O$="New download.":GOSUB30:RETURN
4680 IFPEEK(839)THENRETURN
4685 A$=DA$:M=VAL(LEFT$(A$,2)):DA$=MID$(A$,3,3)
4690 IFLEFT$(DA$,1)="/"THENDA$=MID$(DA$,2)
4695 D=VAL(DA$):Y=VAL(RIGHT$(A$,2))
4700 IF(M=1ORM=3ORM=5ORM=7ORM=8ORM=10)ANDD=31GOTO4725
4705 IFM=2ANDD=28GOTO4725
4710 IF(M=4ORM=6ORM=9ORM=11)ANDD=30GOTO4725
4715 IFM=12ANDD=31THENM=1:D=1:Y=Y+1:GOTO4735
4720 GOTO4730
4725 D=0:M=M+1
4730 D=D+1
4735 DA$=MID$(STR$(M),2)+"/"+MID$(STR$(D),2)+"/"+MID$(STR$(Y),2):BB$=A$
4740 GOSUB1920:POKE839,1:GOSUB5060:CLR:GOTO15
4745 GOSUB520:N=VAL(LEFT$(TM$,2)):IF(N=12ORN=1)ANDRIGHT$(TM$,2)="am"THENGOSUB4680
4750 IFRIGHT$(TM$,2)="pm"THENPOKE839,0
4755 RETURN
4760 IFGUTHENRETURN
4765 NW=0:PRINT:PRINT"Old sec. level";:PRINTSL:INPUT"New level";SL$:GOSUB125
4770 B$="":IFPEEK(843)=0GOTO4790
4775 IFSL>PEEK(681)GOTO4790
4780 GOSUB110:PRINT"credits avail:";:PRINTA:INPUT"# of credits to ADD:";B$
4785 GOSUB125
4790 R=UN+1:GOSUB90:GOSUB5455:W1%=W1%+VAL(LEFT$(B$,3)):GOSUB90:GOSUB4260
4792 IFSL$=""THENRETURN
4795 SL=VAL(LEFT$(SL$,2)):ZG=SL:GOSUB45:GOSUB25:GOSUB165:RETURN
4800 CLOSE5:OPEN5,2,0,CHR$(6):GOSUB5310:POKE198,0:TY$="psp"
4805 DB=8:SL=10:POKE840,1:Z=1:GOSUB4930
4810 PRINT"{cyan}{clear}{down}[1] ASCII term":PRINT"[2] Graphics term"
4815 PRINT"[3] Baud rate: 2400":PRINT"[4] Download":PRINT"[5] Upload"
4820 PRINT"[6] Drive number";:PRINTDB:PRINT"[7] i0: cmd":PRINT"[8] Directory"
4825 PRINT"{down}F8 for BBS":A$="":POKE53269,0
4830 GETA$:IFA$=""GOTO4830
4835 IFA$="{f8}"THENPRINT"{red}hold":CLR:GOTO15
4840 A=VAL(A$):IFA=1THENMQ=0:GOTO4885
4845 IFA=2THENMQ=1:GOTO4885
4855 IFA=3THENGOSUB5310
4860 IFA=4THENGOSUB5670:GOTO4895
4865 IFA=5THENGOSUB5690:GOTO4895
4870 IFA=6THENINPUT"Drive number";DE
4871 IFA=7THENINPUT"Drive Command:";I$:CLOSE15:OPEN15,DE,15,I$:CLOSE15
4875 IFA=8THENNR%=1:GOSUB2925:GOTO4895
4880 GOTO4810
4885 IFMQ=0THENPRINT"{clear}{down}ASCII term"
4890 IFMQTHENPRINT"{clear}{down}GRAPHICS term"
4895 PRINT"{down}F1 for menu{down}":POKE848,MQ:SYS49173:SYS49167:GOTO4810
4900 I=1:FORI=1TOLS%:A8$="":Z=1:FORZ=1TOLEN(AR$(I))
4905 A$=MID$(AR$(I),Z,1):IFA$<CHR$(32)ORA$>CHR$(218)THENA$=""
4910 IFA$>CHR$(122)ANDA$<CHR$(193)THENA$=""
4915 A8$=A8$+A$:NEXT:AR$(I)=A8$:NEXT:RETURN
4925 RETURN
4930 GOTO4950
4950 IFZ=1THENRETURN
4951 PRINT"{clear}";:CLOSE15
4955 OPEN15,DA,14,DW$:CLOSE15:CLOSE8:OPEN8,DA,2,"0:data.file2":SYS51232:GOTO3670
4960 T=TI+1000
4965 SYS51339:IFPEEK(251)=0GOTO3670
4970 IFTI<TGOTO4965
4975 GOSUB65:GOTO3670
4980 GOSUB250:IFI$=G$THENAB=1:RETURN
4985 A2=INT(VAL(I$)):GOSUB195
4986 GOSUB252:CLOSE15:OPEN15,A2,15,I$:CLOSE15:RETURN
4990 O$="{reverse on}Enter new file.":GOSUB30:GOSUB1140:IFAGTHENAG=0:RETURN
4995 DE=DA:R$="Save as {reverse on}[?]{reverse off}for help=:>":GOSUB40:GOSUB5095:P$=LEFT$(I$,16)
5000 IFP$="?"THENGOSUB6000:DE=DA:FT$="data.file5":GOSUB1465:GOTO4995
5005 IFP$=G$THENO$="abort":GOSUB30:RETURN
5010 GOSUB4980:IFABGOTO4995
5015 O$="saving "+P$+" to"+STR$(A2):GOSUB30:GOSUB20:PRINT#15,"s0:"+P$
5020 GOSUB25:OPEN8,A2,2,"0:"+P$+",s,w":IFP$="welcome"THENPRINT#8,DA$
5025 GOSUB210:O$="saved":GOSUB30:RETURN
5030 C4=0
5035 A=PEEK(52704+C4):IFA=13ORA=141THENPRINT#6:RETURN
5040 IFC4=255THENRETURN
5045 IFA<32ORA>127ANDA<160GOTO5055
5050 PRINT#6,CHR$(A);
5055 C4=C4+1:GOTO5035
5060 IFPEEK(834)=2THENRETURN
5065 GOSUB180:PRINT#8:PRINT#8,"DATE CHANGE - SYSTEM{sh space}STATS":PRINT#8
5070 PRINT#8,"Todays date{space*5}- "+BB$
5075 PRINT#8,"Calls today{space*5}-"+STR$(PEEK(830))
5080 PRINT#8,"Jerks booted{space*4}-"+STR$(PEEK(832))
5085 PRINT#8,"New Users{space*7}-"+STR$(PEEK(833)):PRINT#8:GOSUB25:POKE830,0
5090 POKE832,0:POKE833,0:RETURN
5095 IFI$=""THENRETURN
5100 SC$="":K=1:FORK=1TOLEN(I$):A=ASC(MID$(I$,K,1))
5105 IFA>192ANDA<219THENA=A-128
5110 IFA>95ANDA<123THENA=A-32
5115 IFA<32ANDA<>13THENA=0
5120 IFKZ%=1AND(A>90ORA<48ANDA<>13ANDA<>32)THENA=0
5125 IFATHENSC$=SC$+CHR$(A)
5130 NEXT:I$=SC$:RETURN
5135 KZ%=1:O$="{yellow}{clear}{down}{reverse on}U.S.S. MENU":GOSUB30:GOSUB35
5140 O$="{cyan}{reverse on}[1]{reverse off} {blue}Search by username":GOSUB30
5145 O$="{cyan}{reverse on}[2]{reverse off} {blue}by location":GOSUB30
5150 O$="{cyan}{reverse on}[3]{reverse off} {blue}by Computer":GOSUB30:GOSUB35:GOSUB235:GOSUB95
5155 H=VAL(I$):GOSUB35:IFH=1THENR$="{green}name:=>":GOSUB40
5160 IFH=2THENR$="{green}City,state:=>":GOSUB40
5165 IFH=3THENR$="{green}Computer:=>":GOSUB40
5170 IFH<1ORH>3ORI$=G$THENRETURN
5175 O$="{clear}{reverse on}Any key aborts":GOSUB30:R=1:GOSUB5095:BB$=LEFT$(I$,3)
5180 CC$=I$:GOSUB90
5185 R=R+1:K7%=2:IFAB=1ORR>=NUGOTO5220
5190 GOSUB5455:I$=ZA$:XX$=I$:IFH=2THENI$=ZY$:XX$=I$
5195 IFH=3THENI$=ZX$:XX$=I$
5200 GOSUB5095:GOSUB100
5205 IFI$=BB$THENGOSUB35:O$="{cyan}{reverse on}["+STR$(R-1)+"]{reverse off}{blue} "+XX$+" "+CC$+" "+ZA$:GOSUB30:GOTO5185
5210 GOSUB175:GET#5,A$:IFA$>""ORPEEK(197)<>64GOTO5220
5215 GOTO5185
5220 GOSUB25:GOSUB35:R$="{yellow}{reverse on}Hit Return":GOSUB40:GOSUB35:RETURN
5225 O$="{clear}User Purge":GOSUB30:GOSUB35
5230 O$="by month and security lvl.":GOSUB30:GOSUB35
5235 R$="# of month to purge:=>":GOSUB40:GOSUB115:L1=VAL(I$)
5240 IFI$=G$THENRETURN
5245 R$="Max sec. to purge:=>":GOSUB40:GOSUB115:L2=VAL(I$)
5250 IFI$=G$THENRETURN
5255 GOSUB35:O$="{reverse on}Purging-":GOSUB30:GOSUB90:R=3:FORR=3TONU+1:GOSUB5455
5260 IFVAL(LEFT$(ZW$,2))=L1ANDZG<=L2THENL5=L5+1:GOSUB5275
5265 O$=STR$(R-1):GOSUB30:NEXT:O$=STR$(L5)+" users purged-":GOSUB30
5270 GOSUB25:RETURN
5275 O$=STR$(R-1)+" deleted":GOSUB30:Y=1:GOSUB3915:GOSUB90:RETURN
5280 O$="2400 baud":GOSUB30:RETURN
5305 GOSUB30:RP=1:GOSUB40
5310 CS=1022730:RC=CS/2400:POKE659,10
5315 GOSUB5335:POKE51968,LO:POKE51969,HI
5320 RC=390:GOSUB5335
5325 POKE665,LO:POKE666,HI:RC=CS/2400/2-100:GOSUB5335:POKE661,LO:POKE662,HI
5330 P2=60/255/2400/10:SYS49176:GOSUB125:POKE670,PEEK(669):RETURN
5335 HI=INT(RC/256):LO=INT(RC-HI*256):RETURN
5340 D9=FRE(0)-1000:QP%=1:QA=0
5345 R$="Filename=:>":GOSUB40:IFI$=G$THENAB=1:RETURN
5350 A1$=I$:GOSUB4980:IFABTHENRETURN
5355 QA=1:GOSUB25:GOSUB20:OPEN8,A2,2,"0:"+A1$+",s,r":LS%=1:GOSUB4270
5360 IFEN>20THENGOSUB25:GOTO5340
5365 IFN%=1THENN%=0:QA=0:RETURN
5370 IFAG=1GOTO5390
5375 C4=52704:SYS52640:LS%=LS%+1:IF(ST)THENAG=1
5380 IFD9<250ORLS%>74THENO$="{red}{reverse on}Editor is full!":AG=0:GOSUB25:RETURN
5385 I$="":GOSUB5395:AR$(LS%)=I$:D9=D9-LEN(I$):GOTO5370
5390 GOSUB25:AG=0:RETURN
5395 I$=I$+CHR$(PEEK(C4)):IFPEEK(C4)=13ORLEN(I$)>253THENRETURN
5400 C4=C4+1:GOTO5395
5405 A$="":B$="":B$=I$:IFLS%>=100GOTO2725
5410 A$=RIGHT$(B$,1)+A$:B$=LEFT$(B$,LEN(B$)-1)
5415 IFLEN(B$)<1THENAR$(LS%)=I$:D9=D9-LEN(I$):LS%=LS%+1:GOSUB35:I$="":GOTO5450
5420 IFRIGHT$(B$,1)<>CHR$(32)GOTO5410
5425 I$=LEFT$(I$,LEN(I$)-1):PRINTCHR$(20);
5430 IFPEEK(840)<>1THENPRINT#5,RB$;:IFRIGHT$(I$,1)<>CHR$(32)GOTO5425
5435 AR$(LS%)=I$+CHR$(13):D9=D9-LEN(I$):LS%=LS%+1:GOSUB35:I$=A$
5440 A$="":POKE849,0:I=1:FORI=1TOLEN(I$):POKE52704,ASC(MID$(I$,I,1)):SYS53076
5445 NEXT
5450 T=TI:SYS53160:GOTO2420
5455 GOSUB4260:SYS52640:C4=52704:GOSUB5490:ZA$=I$:IFK7%=1THENK7%=0:RETURN
5460 GOSUB5490:ZC$=I$:GOSUB5490:ZG=VAL(MID$(I$,2)):GOSUB5490
5465 ZH=VAL(MID$(I$,2)):GOSUB5490:ZW$=I$:GOSUB5490:ZX$=I$:GOSUB5490
5470 ZY$=I$:IFK7%=2THENK7%=0:RETURN
5475 GOSUB5490:ZZ$=I$:GOSUB5490:ZD=VAL(MID$(I$,2)):GOSUB5490
5480 W1%=VAL(MID$(I$,2)):W4%=W1%:GOSUB5490:W2%=VAL(MID$(I$,2)):W5%=W2%:GOSUB5490
5485 W3%=VAL(MID$(I$,2)):W6%=W3%:RETURN
5490 A$="":I$=""
5495 A$=CHR$(PEEK(C4)):IFA$=","ORA$=CHR$(13)ORLEN(I$)>40THENC4=C4+1:RETURN
5500 I$=I$+A$:C4=C4+1:GOTO5495
5505 N%=1:GOSUB5345:IFABTHENRETURN
5510 DE=A2:FT$=A1$:GOSUB1465:DE=8:R$="Press a key":RP=1:GOSUB40
5515 RETURN
5520 R$="Drive #:>":GOSUB40:GOSUB100:J=VAL(I$):IFI$=G$THENRETURN
5530 D$="v0"
5535 O$="Val":GOSUB30:A=J:CLOSE15:OPEN15,A,15,D$:CLOSE15:RETURN
5540 GOSUB5815:O$="add lib":GOSUB30:GOSUB35:R$="Filename to convert=:>"
5545 GOSUB40:P$=LEFT$(I$,16):IFI$=G$THENRETURN
5550 PRINT"Drive"LZ(SX):R$="Subject:=>":GOSUB40:IFI$=G$GOTO5575
5555 CLOSE15:OPEN15,LZ(SX),15,"r0:"+FT$+"."+STR$(AJ(SX)+1)+"="+P$:GOSUB4270
5560 REM IFEN>20GOTO5575
5565 AJ(SX)=AJ(SX)+1:GOSUB5815:CLOSE8:OPEN8,LZ(SX),2,"0:"+FT$+",a"
5570 PRINT#8,"["+MID$(STR$(AJ(SX)),3)+"] "+I$:GOSUB1920
5575 GOSUB25:RETURN
5580 AB=0:UZ=1:Y%=1:GOSUB3455:IFABTHENRETURN
5585 O$="Old name:>New name":GOSUB30:P$=LEFT$(P$,LEN(P$)-2)
5590 R$=P$+":>":GOSUB40:IFI$=G$THENRETURN
5605 OPEN15,DU(CZ),15,"r0:"+I$+"=0:"+P$:CLOSE15:RETURN
5610 I$=MID$(I$,2):IFLEFT$(I$,1)=":"THENI$=MID$(I$,2):RETURN
5615 IFI$=""ORI$=G$THENPRINT#5,"{f5}";:AB=1:RETURN
5620 GOTO5610
5625 GOSUB465:P$="":GET#5,A$:IFA$=""ANDTI-T<5000GOTO5625
5630 IFA$<>"{f1}"ORSL<PEEK(837)THENAB=1:RETURN
5635 GOSUB465:GET#5,A$:IFA$=G$ORLEN(P$)>16GOTO5655
5640 IFTI-T>10000THENRETURN
5645 IFA$=","ORA$=":"ORA$=";"ORA$="="ORA$="*"ORA$="?"THENAB=1:RETURN
5650 P$=P$+A$:GOTO5635
5655 I$=P$:GOSUB5095:P$=I$:I$="":IFP$=""THENAB=1:RETURN
5660 A2=DB
5665 POKE53269,0:GOTO3300
5670 INPUT"Save as";P$:IFP$=""THENRETURN
5675 SYS49173:SYS49161:T$=","+MID$(TY$,PEEK(51227),1)+",w"
5680 IFPEEK(512)=1GOTO5705
5685 OPEN2,DE,2,"@0:"+P$+T$:SYS61310:SYS49173:SYS49155:GOTO5705
5690 INPUT"File to send";P$:INPUT"Filetype [p,s]";T$:IFP$=""ORT$=""THENRETURN
5695 OPEN2,DE,2,"0:"+P$:POKE51227,1:IFT$="s"THENPOKE51227,2
5700 PRINT:SYS49173:SYS49164:SYS49173:POKE51224,255:SYS49158
5705 CLOSE2:GOSUB2825:POKE54296,0:GOSUB125:PRINT:RETURN
5800 CLOSE15:OPEN15,ZO(VI),15:IFZD$(VI)<>"i0:"THENPRINT#15,ZD$(VI)
5801 CLOSE15:RETURN
5805 CLOSE15:OPEN15,ZO(K),15:IFZD$(K)<>"i0:"THENPRINT#15,ZD$(K)
5806 CLOSE15:RETURN
5815 CLOSE15:OPEN15,LZ(SX),15:IFLD$(SX)<>"i0:"THENPRINT#15,LD$(SX)
5816 CLOSE15:RETURN
5820 CLOSE15:OPEN15,DU(CZ),15:IFDG$(CZ)<>"i0:"THENPRINT#15,DG$(CZ)
5821 CLOSE15:RETURN
5835 DE=CZ
5836 O$="{clear}{down}{yellow}{space*11}{reverse on}The U/D Dirs{purple}":GOSUB30:GOSUB35
5840 O$="{reverse on} #{sh space} name ":GOSUB30:GOSUB35:I=1:FORI=1TOUD
5845 IFSL>=DO(I)THENO$="{cyan}{reverse on}["+MID$(STR$(I),2)+"]{reverse off}{green}":IFI<10THENO$=O$+" "
5855 IFSL>=DO(I)THENO$=O$+" "+UD$(I):GOSUB30
5860 NEXT:GOSUB35:R$="{blue}Select Directory{cyan}{reverse on}[0=abort]{reverse off}{blue}=:>":GOSUB40
5865 GOSUB100:IFI$=G$THENRETURN
5870 CZ=INT(VAL(I$)):IFCZ<1ORCZ>UDTHENGOTO5836
5875 IFSL>=DO(CZ)THENO$="{dark gray}Now Entering:{white} "+UD$(CZ):GOSUB30:RETURN
5880 O$="{purple}Invalid Option":GOSUB30:CZ=DE:RETURN
6000 CLOSE15:OPEN15,DA,15:IFDW$<>"i0:"THENPRINT#15,DW$
6001 CLOSE15:RETURN
6005 CLOSE15:OPEN15,DB,15:IFDX$<>"i0:"THENPRINT#15,DX$
6006 CLOSE15:RETURN
6010 CLOSE15:OPEN15,DC,15:IFDY$<>"i0:"THENPRINT#15,DY$
6011 CLOSE15:RETURN
